## 认识GPU

CPU会把芯片的很大一部分专用于大型控制分支预测。相比之下，GPU有大量大量的计算单元ALUs，用于控制的芯片部分要小很多。CPU和GPU的设计目标是不同的，可以认为CPU是为了优化延迟而设计的（比如说进程调度）；在GPU中，优化的是高吞吐量（只想要所有的任务在总体上尽快完成）。

![](./img/GPU-1.jpg)

GPU有很多的SM(streaming multiprocessors)流式多处理器，可以把它看成GPU中的一个原子单元。当我们在像Triton这样的环境中编程时，它们将在SM级别上运行。在每个SM内，包含许多的SP，流式处理器，它会并行执行大量线程。

也就是说，SM有一堆控制逻辑，它可以决定执行什么，SP将采用相同的指令并将其应用到许多不同的数据片段，所以在这个模型下可以做大量的并行计算。右图是A100，它有128个SM。