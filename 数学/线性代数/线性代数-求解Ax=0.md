## 消元法求解零空间

求解如下方程：
$$
Ax = 0 \quad A = 
\begin{bmatrix}
1 & 2 & 2 & 2 \\
2 & 4 & 6 & 8 \\
3 & 6 & 8 & 10 \\
\end{bmatrix}
$$
通过消元法处理矩阵$A$：
$$
\begin{bmatrix}
1 & 2 & 2 & 2 \\
2 & 4 & 6 & 8 \\
3 & 6 & 8 & 10 \\
\end{bmatrix} \rightarrow
\begin{bmatrix}
1 & 2 & 2 & 2 \\
0 & 0 & 2 & 4 \\
0 & 0 & 0 & 0 \\
\end{bmatrix}
= U
$$
 $A$ 矩阵消元之后只有两个主元：1 和 2（$x_1$和$x_3$），主元的个数被称为秩。

然后就是回代求解。主元所在的列称为主列（$x_1$和$x_3$是$A$的主元），其他的列称为自由列，表示其对应的未知变量$𝑥_𝑛$($n$ 表示自由列是第 $n$ 列)可以被任意分配值。因为回代求解时只有主元列对应的未知数的解有确定值。

 所以这个 U 的主变量(主元)为$𝑥_1$，$𝑥_3$。自由变量为$𝑥_2$，$𝑥_4$。

**接下来对自由变量赋值覆盖零空间（回代）**

1. 首先给自由变量${[x_2 \quad x_4]}^T$取值为${[1 \quad 0]}^T$，解向量为：${[-2 \quad 1 \quad 0 \quad 0]}^T$
2. 给自由变量${[x_2 \quad x_4]}^T$取值为${[0 \quad 1]}^T$，解向量为：${[2 \quad 0 \quad -2 \quad 1]}^T$

自由变量${[x_2 \quad x_4]}^T$已经可以由${[1 \quad 0]}^T$和${[0 \quad 1]}^T$的线性组合所覆盖，所以这两个解向量足够代表零空间的特征了，我们称这两个解向量为：**特解**。

通过**特解的任意倍的线性组合可以构造出整个零空间**。
$$
x = c
\begin{bmatrix}
-2 \\ 1 \\ 0 \\ 0
\end{bmatrix}
+
d
\begin{bmatrix}
2 \\ 0 \\ -2 \\ 1
\end{bmatrix}
$$
对于一个 $m*n$ 的矩阵 $A$，若其秩($R$)为 $r$，那么就意味着其主变量为 $r$ 个，自由变量为 $n-r$ 个。也就是只有 $r$ 个方程起作用，而一共有 $n$ 个变量 $x$，我们将其中的 $n-r$ 个自由变量依次赋值为$\begin{bmatrix}1 \\0 \\0 \\ .. \\0 \end{bmatrix}$，$\begin{bmatrix}0 \\1 \\0 \\ .. \\0 \end{bmatrix}$...$\begin{bmatrix}0 \\0 \\0 \\ .. \\1 \end{bmatrix}$，接下来解方程求特解，将特解的任意倍进行线性组合就可以了。

其实还可以简化，我们对$U$进行列交换，使左上角变为单位阵$I$：
$$
R = 
\begin{bmatrix}
1 & 0 & 2 & -2 \\
0 & 1 & 0 & 2 \\
0 & 0 & 0 & 0 \\
\end{bmatrix}
=
\begin{bmatrix}
I & F \\
\mathbf{0} & \mathbf{0}
\end{bmatrix}
$$

单位阵$I$可以看成主列，右边的$F$是自由列。

现在假设有一个零空间矩阵：即零空间矩阵各列由特解组成，记 $N$ 为零空间矩阵。联系之前学习矩阵乘法时学到的分块乘法，不难得到：
$$
Ax = Rx = 
\begin{bmatrix}
I & F \\
\mathbf{0} & \mathbf{0}
\end{bmatrix}
\begin{bmatrix}
x_{主元} \\
x_{自由变量}
\end{bmatrix}
= 
RN
=
\mathbf{0}
$$
所以零空间矩阵$N = \begin{bmatrix}-F \\ I \end{bmatrix} = \begin{bmatrix}-2 & 2 \\ 0 & -2 \\ 1 & 0 \\ 0 & 1\end{bmatrix}$，再交换回变量的位置，也就得到了方程的特解。


